Profilo ¬∑ HTML
Copia

<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profilo - EduGamer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://fonts.cdnfonts.com/css/opendyslexic" rel="stylesheet">
    
    <!-- GAME SYSTEM -->
    <script src="game-system.js"></script>

    <style>
        * { letter-spacing: 0.02em; }
        html, body, #root { height: 100%; margin: 0; padding: 0; overflow: hidden; }
        body { 
            background: linear-gradient(135deg, #0a0e17 0%, #1a1a2e 100%);
            color: white; 
            font-family: 'OpenDyslexic', Verdana, sans-serif;
        }
        
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background: #475569; border-radius: 4px; }
        
        .scroll-area {
            flex: 1;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        /* XP BAR */
        .xp-bar-bg {
            background: #1e293b;
            border-radius: 9999px;
            height: 24px;
            overflow: hidden;
            position: relative;
        }
        .xp-bar-fill {
            height: 100%;
            border-radius: 9999px;
            transition: width 0.5s ease-out;
            position: relative;
            overflow: hidden;
        }
        .xp-bar-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }
        @keyframes shimmer {
            to { left: 100%; }
        }

        /* ACHIEVEMENT CARD */
        .achievement-card {
            transition: all 0.2s;
        }
        .achievement-card:hover {
            transform: translateY(-2px);
        }
        .achievement-locked {
            filter: grayscale(100%);
            opacity: 0.5;
        }

        /* RARITY COLORS */
        .rarity-comune { border-color: #94a3b8; }
        .rarity-raro { border-color: #3b82f6; }
        .rarity-epico { border-color: #a855f7; }
        .rarity-leggendario { border-color: #fbbf24; }

        /* STAT CARD */
        .stat-card {
            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
            border-radius: 16px;
            padding: 16px;
            text-align: center;
        }

        /* STREAK FIRE */
        .streak-fire {
            animation: flicker 0.5s infinite alternate;
        }
        @keyframes flicker {
            from { transform: scale(1); }
            to { transform: scale(1.1); }
        }

        /* TAB BUTTONS */
        .tab-btn {
            transition: all 0.2s;
        }
        .tab-btn.active {
            transform: scale(1.05);
        }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect } = React;

        const App = () => {
            const [stats, setStats] = useState(null);
            const [level, setLevel] = useState(null);
            const [progress, setProgress] = useState(null);
            const [achievements, setAchievements] = useState([]);
            const [activeTab, setActiveTab] = useState('overview');
            const [showResetModal, setShowResetModal] = useState(false);
            const [tapCount, setTapCount] = useState(0);

            // Carica dati
            const loadData = () => {
                if (window.EduGamer) {
                    setStats(window.EduGamer.getStats());
                    setLevel(window.EduGamer.getLevel());
                    setProgress(window.EduGamer.getProgress());
                    setAchievements(window.EduGamer.getAchievements());
                }
            };

            useEffect(() => {
                loadData();
                
                // Ascolta aggiornamenti
                const handleUpdate = () => loadData();
                window.addEventListener('edugamer-stats-updated', handleUpdate);
                window.addEventListener('edugamer-xp-added', handleUpdate);
                
                return () => {
                    window.removeEventListener('edugamer-stats-updated', handleUpdate);
                    window.removeEventListener('edugamer-xp-added', handleUpdate);
                };
            }, []);

            // Reset nascosto: tocca 5 volte velocemente il titolo
            const handleTitleTap = () => {
                const newCount = tapCount + 1;
                setTapCount(newCount);
                
                if (newCount >= 5) {
                    setShowResetModal(true);
                    setTapCount(0);
                }
                
                // Reset contatore dopo 2 secondi
                setTimeout(() => setTapCount(0), 2000);
            };

            // Funzione di reset
            const performReset = () => {
                localStorage.removeItem('edu_xp');
                localStorage.removeItem('edu_level');
                localStorage.removeItem('edu_achievements');
                localStorage.removeItem('edu_streak');
                localStorage.removeItem('edu_stats');
                localStorage.removeItem('edu_last_activity');
                localStorage.removeItem('lavagna_interactive_v2');
                setShowResetModal(false);
                window.location.reload();
            };

            // Stato per menu report
            const [showReportMenu, setShowReportMenu] = React.useState(false);

            // Genera testo report
            const generateReport = () => {
                const oggi = new Date();
                const dataReport = oggi.toLocaleDateString('it-IT', { 
                    weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' 
                });
                
                // Calcola valutazione automatica
                let valutazione = '';
                if (stats.currentStreak >= 5) {
                    valutazione = 'Ottimo! Sta usando l\'app con costanza!';
                } else if (stats.currentStreak >= 3) {
                    valutazione = 'Buon utilizzo, continua cosi!';
                } else if (stats.totalActivities > 0) {
                    valutazione = 'Ha iniziato a usare l\'app. Incoraggialo a continuare!';
                } else {
                    valutazione = 'Non ha ancora usato l\'app questa settimana.';
                }

                const report = `REPORT EDUGAMER
${dataReport}

LIVELLO E PROGRESSI
Livello: ${level.level} - ${level.name}
XP Totali: ${stats.totalXP}
Trofei sbloccati: ${achievements.filter(a => a.unlocked).length}/${achievements.length}

COSTANZA
Streak attuale: ${stats.currentStreak} giorni consecutivi
Record streak: ${stats.maxStreak} giorni

ATTIVITA COMPLETATE
Problemi matematica risolti: ${stats.problemsSolved}
Testi controllati: ${stats.textsChecked}
Testi perfetti (zero errori): ${stats.perfectTexts}
Mappe mentali create: ${stats.mapsCreated}
Domande al tutor: ${stats.tutorQuestions}
Quiz completati: ${stats.quizCompleted}

VALUTAZIONE
${valutazione}

---
Report generato da EduGamer`;

                return report;
            };

            // Condividi via WhatsApp
            const shareReportWhatsApp = () => {
                const report = generateReport();
                const msg = encodeURIComponent(report);
                window.open(`https://wa.me/?text=${msg}`, '_blank');
                setShowReportMenu(false);
            };

            // Condividi via Email
            const shareReportEmail = () => {
                const report = generateReport();
                const subject = encodeURIComponent(`Report EduGamer - ${new Date().toLocaleDateString('it-IT')}`);
                const body = encodeURIComponent(report);
                window.open(`mailto:?subject=${subject}&body=${body}`, '_blank');
                setShowReportMenu(false);
            };

            // Salva come file
            const saveReportFile = () => {
                const report = generateReport();
                const blob = new Blob([report], { type: 'text/plain;charset=utf-8' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `report_edugamer_${new Date().toISOString().slice(0,10)}.txt`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                setShowReportMenu(false);
            };

            if (!stats || !level) {
                return (
                    <div className="h-full flex items-center justify-center">
                        <div className="text-2xl">‚è≥ Caricamento...</div>
                    </div>
                );
            }

            const unlockedCount = achievements.filter(a => a.unlocked).length;

            return (
                <div className="h-full flex flex-col p-3 gap-3">
                    {/* HEADER */}
                    <div className="flex gap-2 shrink-0">
                        <a href="index.html" className="bg-slate-700 text-white px-4 rounded-xl font-bold flex items-center justify-center text-lg active:scale-95">
                            üè†
                        </a>
                        <div className="flex-1 bg-slate-800 rounded-xl p-3 flex items-center gap-3">
                            <div className="text-4xl">{level.icon}</div>
                            <div className="flex-1">
                                <div className="flex justify-between items-center mb-1">
                                    <span 
                                        className="font-bold text-lg select-none" 
                                        style={{color: level.color}}
                                        onClick={handleTitleTap}
                                    >
                                        Lv.{level.level} {level.name}
                                    </span>
                                    <span className="text-yellow-400 font-bold">{stats.totalXP} XP</span>
                                </div>
                                <div className="xp-bar-bg">
                                    <div 
                                        className="xp-bar-fill"
                                        style={{
                                            width: `${progress.progress}%`,
                                            background: `linear-gradient(90deg, ${level.color}, ${level.color}dd)`
                                        }}
                                    ></div>
                                </div>
                                <div className="text-xs text-slate-400 mt-1 text-right">
                                    {progress.isMax ? 'üåü LIVELLO MASSIMO!' : `${progress.current}/${progress.required} al prossimo livello`}
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* STREAK BANNER */}
                    {stats.currentStreak > 0 && (
                        <div className="bg-gradient-to-r from-orange-600 to-red-600 rounded-xl p-3 flex items-center justify-center gap-3">
                            <span className="text-3xl streak-fire">üî•</span>
                            <div className="text-center">
                                <div className="text-2xl font-bold">{stats.currentStreak} GIORNI</div>
                                <div className="text-sm opacity-80">Serie consecutiva!</div>
                            </div>
                            <span className="text-3xl streak-fire">üî•</span>
                        </div>
                    )}

                    {/* TABS */}
                    <div className="flex gap-2 shrink-0">
                        <button 
                            onClick={() => setActiveTab('overview')}
                            className={`tab-btn flex-1 py-2 rounded-xl font-bold ${activeTab === 'overview' ? 'bg-blue-600 text-white active' : 'bg-slate-800 text-slate-400'}`}
                        >
                            üìä Panoramica
                        </button>
                        <button 
                            onClick={() => setActiveTab('achievements')}
                            className={`tab-btn flex-1 py-2 rounded-xl font-bold ${activeTab === 'achievements' ? 'bg-yellow-600 text-white active' : 'bg-slate-800 text-slate-400'}`}
                        >
                            üèÜ Trofei ({unlockedCount}/{achievements.length})
                        </button>
                        <button 
                            onClick={() => setActiveTab('stats')}
                            className={`tab-btn flex-1 py-2 rounded-xl font-bold ${activeTab === 'stats' ? 'bg-green-600 text-white active' : 'bg-slate-800 text-slate-400'}`}
                        >
                            üìà Statistiche
                        </button>
                    </div>

                    {/* PULSANTE INVIA REPORT */}
                    <button 
                        onClick={() => setShowReportMenu(true)}
                        className="w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white py-3 rounded-xl font-bold active:scale-95 flex items-center justify-center gap-2 shrink-0"
                    >
                        üìß Invia Report ai Genitori
                    </button>

                    {/* CONTENT */}
                    <div className="scroll-area bg-slate-900 rounded-2xl p-4">
                        
                        {/* PANORAMICA */}
                        {activeTab === 'overview' && (
                            <div className="space-y-4">
                                {/* Quick Stats */}
                                <div className="grid grid-cols-2 gap-3">
                                    <div className="stat-card border-2 border-blue-500">
                                        <div className="text-3xl mb-1">üßÆ</div>
                                        <div className="text-2xl font-bold text-blue-400">{stats.problemsSolved}</div>
                                        <div className="text-xs text-slate-400">Problemi risolti</div>
                                    </div>
                                    <div className="stat-card border-2 border-green-500">
                                        <div className="text-3xl mb-1">‚úçÔ∏è</div>
                                        <div className="text-2xl font-bold text-green-400">{stats.textsChecked}</div>
                                        <div className="text-xs text-slate-400">Testi controllati</div>
                                    </div>
                                    <div className="stat-card border-2 border-purple-500">
                                        <div className="text-3xl mb-1">üó∫Ô∏è</div>
                                        <div className="text-2xl font-bold text-purple-400">{stats.mapsCreated}</div>
                                        <div className="text-xs text-slate-400">Mappe create</div>
                                    </div>
                                    <div className="stat-card border-2 border-yellow-500">
                                        <div className="text-3xl mb-1">üí¨</div>
                                        <div className="text-2xl font-bold text-yellow-400">{stats.tutorQuestions}</div>
                                        <div className="text-xs text-slate-400">Domande al tutor</div>
                                    </div>
                                </div>

                                {/* Recent Achievements */}
                                <div>
                                    <h3 className="text-lg font-bold text-yellow-400 mb-3">üèÜ Ultimi Trofei Sbloccati</h3>
                                    <div className="space-y-2">
                                        {achievements.filter(a => a.unlocked).slice(-3).reverse().map(a => (
                                            <div key={a.id} className={`flex items-center gap-3 p-3 rounded-xl bg-slate-800 border-2 rarity-${a.rarity}`}>
                                                <span className="text-3xl">{a.icon}</span>
                                                <div className="flex-1">
                                                    <div className="font-bold">{a.name}</div>
                                                    <div className="text-xs text-slate-400">{a.desc}</div>
                                                </div>
                                                <div className="text-green-400 font-bold">+{a.xpReward} XP</div>
                                            </div>
                                        ))}
                                        {achievements.filter(a => a.unlocked).length === 0 && (
                                            <div className="text-center text-slate-500 py-6">
                                                <div className="text-4xl mb-2">üéØ</div>
                                                <p>Completa attivit√† per sbloccare trofei!</p>
                                            </div>
                                        )}
                                    </div>
                                </div>

                                {/* Next Level Info */}
                                {!progress.isMax && (
                                    <div className="bg-slate-800 rounded-xl p-4 border-2 border-slate-600">
                                        <h3 className="text-lg font-bold mb-2">üéØ Prossimo Obiettivo</h3>
                                        <div className="flex items-center gap-3">
                                            <div className="text-4xl">
                                                {window.EduGamer?.LEVELS[level.level]?.icon || '‚¨ÜÔ∏è'}
                                            </div>
                                            <div>
                                                <div className="font-bold">
                                                    Livello {level.level + 1}: {window.EduGamer?.LEVELS[level.level]?.name || 'Prossimo'}
                                                </div>
                                                <div className="text-sm text-slate-400">
                                                    Mancano {progress.required - progress.current} XP
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                )}
                            </div>
                        )}

                        {/* ACHIEVEMENTS */}
                        {activeTab === 'achievements' && (
                            <div className="space-y-3">
                                {['leggendario', 'epico', 'raro', 'comune'].map(rarity => {
                                    const rarityAchievements = achievements.filter(a => a.rarity === rarity);
                                    if (rarityAchievements.length === 0) return null;
                                    
                                    const rarityNames = {
                                        comune: '‚ö™ Comuni',
                                        raro: 'üîµ Rari',
                                        epico: 'üü£ Epici',
                                        leggendario: 'üü° Leggendari'
                                    };
                                    
                                    return (
                                        <div key={rarity}>
                                            <h3 className="text-sm font-bold text-slate-400 mb-2 uppercase tracking-wider">
                                                {rarityNames[rarity]}
                                            </h3>
                                            <div className="grid grid-cols-1 gap-2">
                                                {rarityAchievements.map(a => (
                                                    <div 
                                                        key={a.id} 
                                                        className={`achievement-card flex items-center gap-3 p-3 rounded-xl bg-slate-800 border-2 rarity-${a.rarity} ${!a.unlocked ? 'achievement-locked' : ''}`}
                                                    >
                                                        <span className="text-3xl">{a.unlocked ? a.icon : 'üîí'}</span>
                                                        <div className="flex-1">
                                                            <div className="font-bold">{a.name}</div>
                                                            <div className="text-xs text-slate-400">{a.desc}</div>
                                                        </div>
                                                        <div className={`font-bold ${a.unlocked ? 'text-green-400' : 'text-slate-500'}`}>
                                                            {a.unlocked ? '‚úì' : `+${a.xpReward}`}
                                                        </div>
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                    );
                                })}
                            </div>
                        )}

                        {/* STATISTICHE */}
                        {activeTab === 'stats' && (
                            <div className="space-y-4">
                                {/* Generali */}
                                <div>
                                    <h3 className="text-lg font-bold text-blue-400 mb-3">üìä Generali</h3>
                                    <div className="bg-slate-800 rounded-xl divide-y divide-slate-700">
                                        <div className="flex justify-between p-3">
                                            <span className="text-slate-400">XP Totali</span>
                                            <span className="font-bold text-yellow-400">{stats.totalXP}</span>
                                        </div>
                                        <div className="flex justify-between p-3">
                                            <span className="text-slate-400">Livello</span>
                                            <span className="font-bold">{level.level} - {level.name}</span>
                                        </div>
                                        <div className="flex justify-between p-3">
                                            <span className="text-slate-400">Attivit√† completate</span>
                                            <span className="font-bold">{stats.totalActivities}</span>
                                        </div>
                                        <div className="flex justify-between p-3">
                                            <span className="text-slate-400">Trofei sbloccati</span>
                                            <span className="font-bold">{unlockedCount}/{achievements.length}</span>
                                        </div>
                                    </div>
                                </div>

                                {/* Streak */}
                                <div>
                                    <h3 className="text-lg font-bold text-orange-400 mb-3">üî• Streak</h3>
                                    <div className="bg-slate-800 rounded-xl divide-y divide-slate-700">
                                        <div className="flex justify-between p-3">
                                            <span className="text-slate-400">Serie attuale</span>
                                            <span className="font-bold text-orange-400">{stats.currentStreak} giorni</span>
                                        </div>
                                        <div className="flex justify-between p-3">
                                            <span className="text-slate-400">Record massimo</span>
                                            <span className="font-bold text-yellow-400">{stats.maxStreak} giorni</span>
                                        </div>
                                    </div>
                                </div>

                                {/* Per Modulo */}
                                <div>
                                    <h3 className="text-lg font-bold text-green-400 mb-3">üìö Per Modulo</h3>
                                    <div className="bg-slate-800 rounded-xl divide-y divide-slate-700">
                                        <div className="flex justify-between p-3">
                                            <span className="text-slate-400">üßÆ Operazioni matematiche</span>
                                            <span className="font-bold">{stats.mathOperations}</span>
                                        </div>
                                        <div className="flex justify-between p-3">
                                            <span className="text-slate-400">üìê Problemi risolti</span>
                                            <span className="font-bold">{stats.problemsSolved}</span>
                                        </div>
                                        <div className="flex justify-between p-3">
                                            <span className="text-slate-400">‚úçÔ∏è Testi controllati</span>
                                            <span className="font-bold">{stats.textsChecked}</span>
                                        </div>
                                        <div className="flex justify-between p-3">
                                            <span className="text-slate-400">‚úÖ Testi perfetti</span>
                                            <span className="font-bold text-green-400">{stats.perfectTexts}</span>
                                        </div>
                                        <div className="flex justify-between p-3">
                                            <span className="text-slate-400">üó∫Ô∏è Mappe create</span>
                                            <span className="font-bold">{stats.mapsCreated}</span>
                                        </div>
                                        <div className="flex justify-between p-3">
                                            <span className="text-slate-400">üí¨ Domande al tutor</span>
                                            <span className="font-bold">{stats.tutorQuestions}</span>
                                        </div>
                                        <div className="flex justify-between p-3">
                                            <span className="text-slate-400">üéØ Quiz completati</span>
                                            <span className="font-bold">{stats.quizCompleted}</span>
                                        </div>
                                    </div>
                                </div>

                                {/* Badge Speciali */}
                                <div>
                                    <h3 className="text-lg font-bold text-purple-400 mb-3">‚ú® Badge Speciali</h3>
                                    <div className="flex gap-3 flex-wrap">
                                        {stats.nightOwl && (
                                            <div className="bg-slate-800 rounded-xl p-3 flex items-center gap-2 border-2 border-purple-500">
                                                <span className="text-2xl">ü¶â</span>
                                                <span className="font-bold">Gufo Notturno</span>
                                            </div>
                                        )}
                                        {stats.earlyBird && (
                                            <div className="bg-slate-800 rounded-xl p-3 flex items-center gap-2 border-2 border-yellow-500">
                                                <span className="text-2xl">üê¶</span>
                                                <span className="font-bold">Mattiniero</span>
                                            </div>
                                        )}
                                        {!stats.nightOwl && !stats.earlyBird && (
                                            <div className="text-slate-500 text-sm">
                                                Studia in orari speciali per sbloccare badge!
                                            </div>
                                        )}
                                    </div>
                                </div>

                                {/* Data inizio */}
                                {stats.firstPlayDate && (
                                    <div className="text-center text-slate-500 text-sm pt-4 border-t border-slate-700">
                                        üéÆ Giocatore dal {new Date(stats.firstPlayDate).toLocaleDateString('it-IT')}
                                    </div>
                                )}
                            </div>
                        )}
                    </div>

                    {/* MODAL RESET */}
                    {showResetModal && (
                        <div className="fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4">
                            <div className="bg-slate-800 rounded-2xl p-6 w-full max-w-sm border-2 border-red-500">
                                <div className="text-center mb-4">
                                    <div className="text-5xl mb-3">‚ö†Ô∏è</div>
                                    <h3 className="text-xl font-bold text-red-400">Reset Progressi</h3>
                                </div>
                                
                                <p className="text-center text-slate-300 mb-6">
                                    Vuoi azzerare tutti i progressi?
                                </p>
                                
                                <div className="flex gap-3">
                                    <button 
                                        onClick={() => setShowResetModal(false)}
                                        className="flex-1 bg-slate-600 text-white py-3 rounded-xl font-bold active:scale-95"
                                    >
                                        Annulla
                                    </button>
                                    <button 
                                        onClick={performReset}
                                        className="flex-1 bg-red-600 text-white py-3 rounded-xl font-bold active:scale-95"
                                    >
                                        Azzera
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* MODAL REPORT */}
                    {showReportMenu && (
                        <div className="fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4" onClick={() => setShowReportMenu(false)}>
                            <div className="bg-slate-800 rounded-2xl p-6 w-full max-w-sm border-2 border-purple-500" onClick={e => e.stopPropagation()}>
                                <div className="text-center mb-4">
                                    <div className="text-5xl mb-3">üìä</div>
                                    <h3 className="text-xl font-bold text-purple-400">Invia Report</h3>
                                </div>
                                
                                <p className="text-center text-slate-300 mb-6 text-sm">
                                    Scegli come inviare il report ai genitori
                                </p>
                                
                                <div className="flex flex-col gap-3">
                                    <button 
                                        onClick={shareReportWhatsApp}
                                        className="w-full bg-green-600 text-white py-3 rounded-xl font-bold active:scale-95 flex items-center justify-center gap-2"
                                    >
                                        üí¨ WhatsApp
                                    </button>
                                    <button 
                                        onClick={shareReportEmail}
                                        className="w-full bg-blue-600 text-white py-3 rounded-xl font-bold active:scale-95 flex items-center justify-center gap-2"
                                    >
                                        üìß Email
                                    </button>
                                    <button 
                                        onClick={saveReportFile}
                                        className="w-full bg-purple-600 text-white py-3 rounded-xl font-bold active:scale-95 flex items-center justify-center gap-2"
                                    >
                                        üíæ Salva File
                                    </button>
                                    <button 
                                        onClick={() => setShowReportMenu(false)}
                                        className="w-full bg-slate-600 text-white py-3 rounded-xl font-bold active:scale-95 mt-2"
                                    >
                                        ‚úï Chiudi
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>

