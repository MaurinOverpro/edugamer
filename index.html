<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>EduGamer OS - Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        body { background-color: #0a0e17; color: #e2e8f0; font-family: 'Verdana', sans-serif; height: 100vh; overflow: hidden; }
        .cyber-card { background: rgba(30, 41, 59, 0.7); border: 1px solid #334155; transition: all 0.2s ease; }
        .cyber-card:hover { border-color: #4ade80; transform: translateY(-5px); box-shadow: 0 0 20px rgba(74, 222, 128, 0.2); }
        .xp-bar-fill { background: linear-gradient(90deg, #16a34a, #4ade80, #16a34a); background-size: 200% 100%; animation: shimmer 2s infinite linear; }
        @keyframes shimmer { 0% { background-position: -200% 0; } 100% { background-position: 200% 0; } }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect } = React;

        const DB = {
            getKey: () => localStorage.getItem('gemini_api_key') || '',
            setKey: (key) => localStorage.setItem('gemini_api_key', key),
            getXP: () => parseInt(localStorage.getItem('edu_xp') || '0'),
            getLevel: () => Math.floor(Math.sqrt(parseInt(localStorage.getItem('edu_xp') || '0') / 10)) + 1
        };

        const App = () => {
            const [xp, setXp] = useState(DB.getXP());
            const [showSettings, setShowSettings] = useState(false);
            const [key, setKey] = useState(DB.getKey());

            // Aggiorna XP ogni volta che si torna alla pagina
            useEffect(() => {
                const interval = setInterval(() => setXp(DB.getXP()), 1000);
                return () => clearInterval(interval);
            }, []);

            const saveKey = () => { DB.setKey(key); setShowSettings(false); alert("Chiave Salvata!"); };

            const modules = [
                { name: "LAVAGNA AI", file: "lavagna.html", icon: "üß†", color: "text-green-400", border: "border-green-500" },
                { name: "MATEMATICA", file: "matematica.html", icon: "üìê", color: "text-yellow-400", border: "border-yellow-500" },
                { name: "ITALIANO", file: "italiano.html", icon: "üìñ", color: "text-blue-400", border: "border-blue-500" },
                { name: "TUTOR AI", file: "tutor.html", icon: "ü§ñ", color: "text-purple-400", border: "border-purple-500" },
            ];

            if (showSettings) {
                return (
                    <div className="h-full flex items-center justify-center p-6">
                        <div className="bg-slate-800 p-8 rounded-2xl border border-slate-600 max-w-md w-full text-center">
                            <h2 className="text-2xl font-bold mb-4 text-white">‚öôÔ∏è IMPOSTAZIONI</h2>
                            <input type="password" value={key} onChange={e => setKey(e.target.value)} placeholder="API Key..." className="w-full bg-slate-900 p-4 rounded-xl mb-4 text-white outline-none border border-slate-600" />
                            <button onClick={saveKey} className="w-full bg-green-600 text-white font-bold p-4 rounded-xl mb-2">SALVA</button>
                            <button onClick={() => setShowSettings(false)} className="text-slate-400 underline">Indietro</button>
                        </div>
                    </div>
                );
            }

            return (
                <div className="h-full flex flex-col p-6 max-w-4xl mx-auto">
                    <header className="flex justify-between items-center mb-8">
                        <div className="text-3xl font-black text-white flex items-center gap-3">
                            <div className="w-4 h-4 bg-green-500 rounded-full animate-pulse"></div>
                            EDUGAMER OS
                        </div>
                        <button onClick={() => setShowSettings(true)} className="text-2xl">‚öôÔ∏è</button>
                    </header>

                    {/* XP CARD */}
                    <div className="bg-slate-800 p-6 rounded-2xl border border-slate-600 mb-8 shadow-xl">
                        <div className="flex justify-between items-end mb-2">
                            <span className="text-2xl font-bold text-yellow-400">LIVELLO {DB.getLevel()}</span>
                            <span className="text-slate-400">{xp} XP Totali</span>
                        </div>
                        <div className="h-4 bg-slate-900 rounded-full overflow-hidden border border-slate-700">
                            <div className="h-full xp-bar-fill" style={{ width: `${Math.min(100, xp % 100)}%` }}></div>
                        </div>
                        <p className="text-center text-slate-500 text-sm mt-2">Completa le attivit√† per salire di livello!</p>
                    </div>

                    {/* GRID MODULI */}
                    <div className="grid grid-cols-2 gap-4 flex-1 overflow-y-auto">
                        {modules.map(m => (
                            <a key={m.name} href={m.file} className={`cyber-card p-6 rounded-2xl flex flex-col items-center justify-center gap-4 border-2 ${m.border} bg-slate-800/50 no-underline`}>
                                <div className="text-5xl">{m.icon}</div>
                                <h2 className={`text-xl font-bold ${m.color}`}>{m.name}</h2>
                                <span className="text-xs text-slate-400 bg-slate-900 px-3 py-1 rounded-full">CLICCA PER APRIRE</span>
                            </a>
                        ))}
                    </div>
                </div>
            );
        };
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>